"use strict";(()=>{var e={};e.id=697,e.ids=[697],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},82793:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>h,patchFetch:()=>v,requestAsyncStorage:()=>p,routeModule:()=>d,serverHooks:()=>l,staticGenerationAsyncStorage:()=>m});var r={};a.r(r),a.d(r,{GET:()=>c});var s=a(73278),i=a(45002),n=a(54877),o=a(71309);let u=new(a(53524)).PrismaClient;async function c(e){try{let e=await u.user.findMany({take:5,orderBy:{createdAt:"desc"},select:{firstName:!0,lastName:!0,createdAt:!0,role:{select:{name:!0}}}}),t=await u.accessRequest.findMany({take:5,orderBy:{requestedAt:"desc"},select:{firstName:!0,lastName:!0,requestedAt:!0,status:!0}}),a=[],r=1;return e.forEach(e=>{a.push({id:r++,type:"USER_CREATED",user:`${e.firstName} ${e.lastName}`,action:`New user account created with role: ${e.role.name}`,timestamp:e.createdAt.toISOString(),status:"SUCCESS"})}),t.forEach(e=>{a.push({id:r++,type:"REQUEST_SUBMITTED",user:`${e.firstName} ${e.lastName}`,action:"Submitted system access request",timestamp:e.requestedAt.toISOString(),status:e.status})}),a.sort((e,t)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime()),o.NextResponse.json(a.slice(0,10))}catch(e){return console.error("Error fetching admin activities:",e),o.NextResponse.json({error:"Failed to fetch admin activities"},{status:500})}}let d=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/admin/activities/route",pathname:"/api/admin/activities",filename:"route",bundlePath:"app/api/admin/activities/route"},resolvedPagePath:"/workspace/app/api/admin/activities/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:p,staticGenerationAsyncStorage:m,serverHooks:l}=d,h="/api/admin/activities/route";function v(){return(0,n.patchFetch)({serverHooks:l,staticGenerationAsyncStorage:m})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[787,833],()=>a(82793));module.exports=r})();